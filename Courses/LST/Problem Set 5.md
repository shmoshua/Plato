#Series #LST 

##### Exercise 1
1. Firstly, we know that a finite-dimensional vector space is Banach w.r.t. any norm. Therefore, $(\mathbb{R}^n,\mathbb{R},\|\cdot\|_{Q})$  is Banach and $(\mathbb{R}^n,\mathbb{R},\braket{ \cdot , \cdot }_{Q})$ is a Hilbert space. For the adjoint $\mathcal{A}^{*}$, as $\mathcal{A}^{*}$ is linear, there exists $B\in \mathbb{R}^{n,m}$ s.t. $\mathcal{A}^{*}(x)=Bx$ for all $x\in \mathbb{R}^m$. Then, we have that for all $x\in \mathbb{R}^m$ and $y\in \mathbb{R}^n$, $$x^\top Ay=\braket{ x , Ay }=\braket{ x , \mathcal{A}(y) }= \braket{ \mathcal{A}^{*}(x) , y }_{Q}=\braket{ Bx , y }_{Q}=x^\top B^\top Qy$$Therefore, we have that $A=B^\top Q$. As $Q$ is symmetric positive definite, $AQ^{-1}=B^\top$ and $$\mathcal{A}^{*}(x)=Q^{-1}A^\top x$$
2. Firstly, as $\text{rank}(A)=m$, $\text{Im }\mathcal{A}=\mathbb{R}^m$. Then, from the finite rank lemma, we have that: $$\mathcal{A}|_{\text{Im }\mathcal{A}^{*}}: \text{Im }\mathcal{A}^{*}\to \text{Im }\mathcal{A}=\mathbb{R}^m$$is a bijection. Therefore, there exists $\hat{x}\in \text{Im }\mathcal{A}^{*}$ s.t. $A\hat{x}=b$. We will show that $\hat{x}$ is the unique minimizer. For any other $x\in \mathbb{R}^n$ s.t. $x\neq \hat{x}$ and $Ax=b$, we have that: $$A(x-\hat{x})=Ax-A\hat{x}=b-b=0$$Therefore, $x-\hat{x}\in \text{ker }\mathcal{A}$. Then, $\left\| x-\hat{x} \right\|_{Q}>0$ as $x\neq \hat{x}$ and: $$x^\top Qx=\|x\|^2_{Q}=\left\| x-\hat{x} \right\|_{Q} ^{2}+\|\hat{x}\|^2_{Q} >\|\hat{x}\|^{2}_{Q}=\hat{x}^\top Q\hat{x}$$This proves the statement.
3. As $\text{Im}(\mathcal{A}\circ\mathcal{A}^{*})=\text{Im }(\mathcal{A})=\mathbb{R}^m$, $\mathcal{A}\circ\mathcal{A}^{*}$ is invertible. From 2, we know that $\hat{x}\in \text{Im }\mathcal{A}^{*}$, i.e. there exists $y\in \mathbb{R}^m$ s.t. $\mathcal{A}^{*}(y)=\hat{x}$ and $(\mathcal{A}\circ\mathcal{A}^{*})(y)=b$. Therefore, $$\hat{x}=\mathcal{A}^{*}(y)=(\mathcal{A}^{*}\circ (\mathcal{A}\circ \mathcal{A}^{*})^{-1})(b)=Q^{-1}A^\top(AQ^{-1}A^\top)^{-1}b$$
---
##### Exercise 2
1. Firstly, we will show that we can assume that $x_{0}=0$. More specifically, $(A,B)$ is controllable in $k$ steps, if and only if for all $x\in \mathbb{R}^n$ there exists $u\in \mathbb{R}^{km}$ that steers $x_{0}=0$ to $x_{k}=x$.
   
   One direction is trivial by definition. Now assume that for all $x\in \mathbb{R}^n$ there exists $u\in \mathbb{R}^{km}$ that steers $x_{0}=0$ to $x_{k}=x$, i.e. $$x=\begin{bmatrix}A^{k-1}B&\dots&AB&B\end{bmatrix}u$$Then, for any $x_{0},x\in \mathbb{R}^n$ we can set $\hat{x}=x-A^kx_{0}$. Then, we have $\hat{u}\in \mathbb{R}^{km}$ s.t. $$x-A^kx_{0}=\hat{x}=\begin{bmatrix}A^{k-1}B&\dots&AB&B\end{bmatrix}\hat{u}$$ 
   Therefore, $(A,B)$ is controllable in $k$ steps. 
   
   This allows us to work with $x_{0}=0$. Now, we define the reachability map as follows: $$\begin{array}{cccc} {\mathcal{L}_{r}:}&{\mathbb{R}^{km}}&\to&{\mathbb{R}^n}\\&{u} &\mapsto & {\begin{bmatrix}A^{k-1}B&\dots&AB&B\end{bmatrix}u} \end{array}{}$$Then, the system is controllable in $k$ steps, if $\text{Im }\mathcal{L}_{r}=\text{Im }\begin{bmatrix}A^{k-1}B&\dots&AB&B\end{bmatrix}=\mathbb{R}^n$. In other words, the condition is that $\text{rank}\begin{bmatrix}A^{k-1}B&\dots&AB&B\end{bmatrix}=n$, as $km\geq nm\geq n$.
2. From 1, we know that if $u\in \mathbb{R}^{km}$ steers $0$ to $\overline{x}-A^kx_{0}$ in $k$ steps, then $u$ steers $x_{0}$ to $\bar{x}$ in $k$ steps. Let us define: $$L_{r}:=\begin{bmatrix}A^{k-1}B&\dots&AB&B\end{bmatrix}\in \mathbb{R}^{n,km}$$Then, by assumption $\text{rank}(L_{r})=n$ and $L_{r}L_{r}^\top$ is symmetric positive definite and therefore invertible. As $\text{Im }L_{r}=\mathbb{R}^n$, there exists a unique $\bar{u}\in \text{Im }L_{r}^\top$ s.t. $L_{r}\bar{u}=\overline{x}-A^kx_{0}$ by the finite rank theorem. Let $\bar{u}=L^\top_{r}x$ for $x\in \mathbb{R}^n$. Then, $$\bar{u}=L^\top_{r}(L_{r}L_{r}^\top)^{-1}(\overline{x}-A^kx_{0})$$We will now show that $\bar{u}$ is the minimum energy controller that achieves this. For $u\in \mathbb{R}^{km}$, if we have that $L_{r}u=\overline{x}-A^kx_{0}$, then:$$L_{r}(\bar{u}-u)=L_{r}\bar{u}-L_{r}u=0$$and $\bar{u}-u\in \text{ker }L_{r}$. As $\bar{u}\in \text{Im }L_{r}^\top$ and $\bar{u}\neq 0$, from the Pythagoras theorem,  $$\|u\|^2_{2}=\|\bar{u}-u\|^2_{2}+\|\bar{u}\|^2_{2}\geq\|\bar{u}\|^2_{2}$$ This proves the statement.
---
##### Exercise 3
1. **Counterexample**: Consider the following $(A,B)$: $$A=\begin{bmatrix}0&1\\0&0\end{bmatrix}, \quad B=\begin{bmatrix}0\\1\end{bmatrix}$$Then, $(A,B)$ is controllable as $\text{Spec}(A)=\{ 0 \}$ and $$\text{rank}\begin{bmatrix}0&-1&0\\0&0&1\end{bmatrix}=2$$However, for $(A^2=0,B)$ and $\lambda=0$, $$\text{rank}\begin{bmatrix}0&0&0\\0&0&1\end{bmatrix}=1$$Therefore, $(A^{2},B)$ is not controllable.
2. True, as $(A,B)$ is controllable, it is also on $[0,1]$. Therefore, there exists $\tilde{u}\in PC([0,1],\mathbb{R}^r)$ that steers $(x_{0},0)$ to $(0,1)$. Then, for $$u(t)=\begin{cases}\tilde{u}(t)&0\leq t<1\\0&1\leq t\end{cases}$$the system is brought to rest at $t=1$. For any $t\geq 1$, $$x(t)=e^{At}x_{0}+\int_{0}^{1}e^{A(t-\tau)} B\tilde{u}(\tau) \, d\tau=0 $$
3. For the system to maintain $x(t)=\overline{x}\in \mathbb{R}^n$ for $t\geq 1$, we need that for all $t\geq 1$: $$0=\dot{x}(t)=Ax(t)+Bu(t)=A\overline{x}+Bu(t)$$
   **Counterexample**: Let$$A=\begin{bmatrix}0&1\\0&0\end{bmatrix}, \quad B=\begin{bmatrix}0\\1\end{bmatrix},\quad \overline{x}=\begin{bmatrix}0\\1\end{bmatrix}$$
   Then, as $(A,B)$ is controllable from 1, we have $u(t):[0,1]\to \mathbb{R}$ that takes $(0,0)$ to $(\overline{x},1)$. However, we do not have $u(t):[1,\infty)\to \mathbb{R}$ s.t. $$0=A\overline{x}+Bu(t)=\begin{bmatrix}1\\0\end{bmatrix}+\begin{bmatrix}0\\1 \end{bmatrix}u(t)$$
---
##### Exercise 4
1. We show with induction. For $t=0$, we have that: $$x_{0}=\overline{x}=A^0\overline{x},\quad y_{0}=C \overline{x}+Du_{0}$$Now assume the statement holds for $t$, then: $$\begin{align}x_{t+1}=Ax_{t}+Bu_{t}&=A\left( A^t\overline{x}+\sum_{i=0}^{t-1}A^{t-1-i}Bu_{i} \right)+Bu_{t}\\&=A^{t+1}\overline{x}+\sum_{i=0}^{t-1}A^{t-i}Bu_{i}+Bu_{t}\\&=A^{t+1}\overline{x}+\sum_{i=0}^{t}A^{t-i}Bu_{i}\end{align} $$and $$\begin{align}y_{t+1}&=Cx_{t+1}+Du_{t+1}=CA^{t+1}\overline{x}+\sum_{i=0}^{t}CA^{t-i}Bu_{i}+Du_{t+1}\end{align}$$
2. If $u_{t}=0$ for all $t\geq 0$, we have: $$\begin{align}x_{t}&=A^t  \overline{x}\end{align}$$Then, if $\left\| A \right\|=\sup_{\lambda\in \text{Spec}(A)}\left| \lambda \right|<1$, then: $$\left\| x_{t} \right\| =\left\| A^t\overline{x} \right\| \leq \left\| A^t \right\| \|\overline{x}\|\leq \left\| A \right\| ^t\left\| \overline{x} \right\| \leq\left\| \overline{x} \right\| $$for all $t\geq 0$, from which the stability holds and $$\lim_{ t \to \infty } \left\| x_{t} \right\| \leq \lim_{ t \to \infty } \left\| A \right\| ^t\left\| \overline{x} \right\| =0$$which proves the convergence.
   
   Conversely, if $\sup_{\lambda\in \text{Spec}(A)}\left| \lambda \right|\geq 1$, for its corresponding eigenvector $\overline{x}\in \mathbb{R}^n$, we have $$\left\| x_{t} \right\| =\left\| A^t \overline{x}\right\|=\left\| \lambda^t\overline{x} \right\| =\left| \lambda \right| ^t\left\| \overline{x} \right\| \geq \left\| \overline{x} \right\|  $$Then, $\lim_{ t \to \infty }\left\| x_{t} \right\|\geq \left\| \overline{x} \right\|>0$. Therefore, the system is not asymptotically stable.
3. Assume that $$P:=\begin{bmatrix}B&AB&\dots&A^{n-1}B\end{bmatrix}\in \mathbb{R}^{n,mn}$$has rank $\text{rank}(P)=n$. Then, we have: $$x_{n}=\sum_{i=0}^{n-1}A^{n-1-i}Bu_{i}=\begin{bmatrix}B&AB&\dots&A^{n-1}B\end{bmatrix}\underbrace{ \begin{bmatrix}u_{n-1}\\u_{n-2}\\ \vdots\\u_{0}\end{bmatrix} }_{ =:u }=Pu$$If $\text{rank}(P)=n$, then $\text{Im}(P)=\mathbb{R}^n$ and for any $\overline{x}\in \mathbb{R}^n$, there exists $u\in \mathbb{R}^{mn}$ s.t. $x_{n}=Pu=\overline{x}$. Therefore, there exists $u_{0},u_{1},\dots,u_{n},\dots$ that steers $x_{0}=0$ to $x_{n}=\overline{x}$ and the system is reachable.
4. For any $\overline{x}\in \mathbb{R}^n$, let $\hat{x}:=-A^t\overline{x}$. Then, from reachability there exists $\hat{u}_{0},\dots,\hat{u}_{n},\dots \in \mathbb{R}^{m}$ that steers $x_{0}=0$ to $x_{n}=\hat{x}$. Therefore, $$-A^n\overline{x}=\hat{x}=\sum_{i=0}^{n-1}A^{n-1-i}B\hat{u}_{i}$$and with the same $\hat{u}$, $x_{n}=A^n\overline{x}+\sum_{i=0}^{n-1}A^{n-1-i}B\hat{u}_{i}=0$.
   
   For the converse, we have the counterexample when $A=0$ and $B=0$. Then, for any $\overline{x}\in \mathbb{R}^n$ and any input $u_{0},u_{1},\dots,u_{n},\dots$ we have $x_{n}=0$, therefore the controllability to zero. However, there is no input sequence that will steer $x_{0}=0$ to $x_{n}=1$, for example. 
5. Assume that the system is controllable to zero and $A$ is invertible. Then, for $\overline{x}\in \mathbb{R}^n$, let $\hat{x}:=-(A^{-1})^n\overline{x}\in \mathbb{R}^n$. By controllability to zero, there exists $\hat{u}_{0},\hat{u}_{1},\dots\in \mathbb{R}^m$ s.t.$$x_{n}=A^n\hat{x}+\sum_{i=1}^{n-1}A^{n-1-i}Bu_{i}=-\overline{x}+\sum_{i=1}^{n-1}A^{n-1-i}Bu_{i}=0$$ Therefore, there exists $\hat{u}_{0},\hat{u}_{1},\dots\in \mathbb{R}^m$ s.t. starting from $x_{0}=0$, $$x_{n}=\sum_{i=1}^{n-1}A^{n-1-i}Bu_{i}=\overline{x}$$ This proves the reachability.
---
##### Exercise 5
1. We have: $$\begin{align}\dot{z}(t)=T\dot{x}(t)=TA(t)x(t)+TB(t)u(t)=\underbrace{ TA(t)T^{-1} }_{ :=\tilde{A}(t) }z(t)+\underbrace{ TB(t) }_{ =:\tilde{B}(t) }u(t)\end{align}$$
2. First we have $\tilde{\Phi}(t,t_{0})=T\Phi(t,t_{0})T^{-1}$ for all $t\geq t_{0}$ as $\tilde{\Phi}(t_{0},t_{0})=I=TT^{-1}$ and: $$\frac{ \partial  }{ \partial t } T\Phi(t,t_{0})=TA(t)\Phi(t,t_{0})=TA(t)T^{-1}T\Phi(t,t_{0})=\tilde{A}(t)T\Phi(t,t_{0})$$by uniqueness. Then, $$\begin{align}\tilde{W}_{r}(t_{0},t_{1})&=\int_{t_{0}}^{t_{1}} \tilde{\Phi}(t_{1},\tau)\tilde{B}(\tau)\tilde{B}(\tau)^\top \tilde{\Phi}(t_{1},\tau)^\top\, d\tau\\&=\int_{t_{0}}^{t_{1}} T\Phi(t_{1},\tau)T^{-1}TB(\tau)B(\tau)^\top T^\top T^{-\top}\Phi(t_{1},\tau)^\top T^\top\, d\tau\\&=\int_{t_{0}}^{t_{1}} T\Phi(t_{1},\tau)B(\tau)B(\tau)^\top \Phi(t_{1},\tau)^\top T^\top\, d\tau\\&=TW_{r}(t_{0},t_{1})T^\top\end{align} $$
3. If system 1 is controllable on $[t_{0},t_{1}]$, we have $\det(W_{r}(t_{0},t_{1}))\neq 0$. For any invertible $T$, we have $\det(T)\neq 0$ and therefore, $$\det(\tilde{W}_{r}(t_{0},t_{1}))=\det(TW_{r}(t_{0},t_{1})T^\top)=\det(T)^{2}\det(W_{r}(t_{0},t_{1}))\neq 0$$Therefore, system 2 is also controllable on $[t_{0},t_{1}]$.
---