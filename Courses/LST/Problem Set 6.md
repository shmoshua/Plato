#Series #LST 

##### Exercise 1
1. We have that: $$\begin{align}y(t)&=Cx(t)+Du(t)\\y^{(1)}(t)&=CAx(t)+CBu(t)+Du^{(1)}(t)\\y^{(2)}(t)&=CA^2x(t)+CABu(t)+CBu^{(1)}(t)+Du^{(2)}(t)\\y^{(3)}(t)&=CA^3x(t)+CA^2Bu(t)+CABu^{(1)}(t)+CBu^{(2)}(t)+Du^{(3)}(t)\\\vdots\\y^{(n-1)}(t)&=CA^{n-1}x(t)+C\sum_{j=0}^{n-2}A^{n-2-j}B u^{(j)}(t)+Du^{(n-1)}(t)\end{align}$$Then, we can write the matrix system: $$\underbrace{ \begin{bmatrix}y^{(0)}(t)\\y^{(1)}(t)\\ \vdots\\y^{(n-1)}(t)\end{bmatrix} }_{ =:Y }=\underbrace{ \begin{bmatrix}C\\CA\\ \vdots\\CA^{n-1}\end{bmatrix} }_{ =:O }x(t)+\underbrace{ \begin{bmatrix}D&&&\\CB&D\\\vdots&\ddots&\ddots\\CA^{n-2}B&CA^{n-3}B&\dots &D\end{bmatrix} }_{ =:M }\underbrace{ \begin{bmatrix}u^{(0)}(t)\\u^{(1)}(t)\\ \vdots\\u^{(n-1)}(t)\end{bmatrix} }_{ =:U }$$where $U,Y\in \mathbb{R}^n$, $O,M\in \mathbb{R}^{n,n}$. From the fact that $(A,C)$ is observable, we have that $O$ is full rank, hence, invertible. Therefore, we can represent: $$x(t)=O^{-1}(Y-MU)$$
2. Because from the Theorem 8.8, we can see that $(C,A)$ is observable on $[t_{0},t_{1}]$ for $t_{0}<t_{1}$ if and only if it  is observable on any $[t_{0},t_{1}]$. Then, we can use the ODEs to find $x(0)$. 
---
##### Exercise 2
1. The controllability matrix is: $$P=\begin{bmatrix}0& \frac{1}{M}&0& \frac{mg}{M^2L}\\ \frac{1}{M}&0& \frac{mg}{M^2L}&0\\0& \frac{1}{ML}&0& \frac{(M+m)g}{M^2L^2}\\  \frac{1}{ML}&0& \frac{(M+m)g}{M^2L^2}&0\end{bmatrix}=\begin{bmatrix}0&0.1&0&0.01\\ 0.1&0&0.01&0\\0&0.1&0&1.01\\ 0.1&0&1.01&0\\\end{bmatrix}$$After Gaussian elimination with pivoting, we get: $$\text{ref}(P)=\begin{bmatrix}0.1&0&0.01&0\\0&0.1&0&0.01\\0&0&1&0\\0&0&0&1\end{bmatrix}$$Therefore, $\text{rank}(P)=4$ and the system is controllable.
2. Let $C=\begin{bmatrix}1&0&0&0\end{bmatrix}$. Then, $$O=\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&0.1&0\\0&0&0&0.1\end{bmatrix}$$which has full rank. This shows that $(C,A)$ is observable.

---
##### Exercise 3
1. We need that: $$\begin{align}\det(\lambda I-A-BK)&=\det \begin{bmatrix}\lambda+2&-1\\-k_{1}&\lambda-1-k_{2}\end{bmatrix}\\&=\lambda^{2}+(1-k_{2})\lambda-2-2k_{2}-k_{1}\\&\overset{ !  }{ = }\lambda^{2}+6\lambda+9\end{align}$$Therefore, $k_{2}=-5$ and $k_{1}=-1$. So we have: $K=[-1\ -5]$. We have two poles at $s=-3$. So the dominant pole is $s=-3$.
2. The observable matrix is: $$O=\begin{bmatrix}0&2\\0&2\end{bmatrix}$$which has rank 1. Therefore, the system is not observable. We notice that $\text{spec}(A)=\{ -2,1 \}$. Further, for $\lambda=-2$, $$\text{rank}\begin{bmatrix}0&-1\\0&-3\\0&2\end{bmatrix}=1<2$$which is unobservable and:$$\text{rank}\begin{bmatrix}3&-1\\0&0\\0&2\end{bmatrix}=2$$which is observable. This means the system is detectable as the unobservable modes have a negative real part.
3. Yes. As we have only one unobservable mode at $s=-2$, we can set the other eigenvalue to a value closer to the imaginary axis than $-2$. For example, we can have $\{ -1,-2 \}$ as desired eigenvalues and: $$\begin{align}\det(\lambda I-A+LC)&=\det \begin{bmatrix}\lambda+2&2\ell_{1}-1\\0&\lambda+2\ell_{2}-1\end{bmatrix}\\&=\lambda^{2}+(2\ell_{2}+1)\lambda+(4\ell_{2}-2)\\&\overset{ ! }{ = }\lambda^{2}+3\lambda+2\end{align}$$Then, $L=\begin{bmatrix}\ell_{1}&1\end{bmatrix}^\top$ for any $\ell_{1}\in \mathbb{R}$ will have dominant pole $-1$.
4. Similarly as above, we have: $$\begin{align}\det(\lambda I-A+LC)&=\det \begin{bmatrix}\lambda+2&2\ell_{1}-1\\0&\lambda+2\ell_{2}-1\end{bmatrix}\\&=\lambda^{2}+(2\ell_{2}+1)\lambda+(4\ell_{2}-2)\\&\overset{ ! }{ = }\lambda^{2}+4\lambda+4\end{align}$$Then, $L=\begin{bmatrix}\ell_{1}& \frac{3}{2}\end{bmatrix}^\top$ for any $\ell_{1}\in \mathbb{R}$ and there are an infinite number of solutions.
5. Assuming we are using the $L$ from 4, by the separation principle, we get that the poles of the closed loop system is $\text{spec}(A+BK)\cup \text{spec}(A-LC)=\{ -2,-3 \}$. Therefore, the dominant pole is $s=-2$.
---
##### Exercise 4
1. For controllability, we have: $$\text{rank }C=\text{rank}\begin{bmatrix}3&0&0\\0&3&0\\0&0&6\end{bmatrix}=3$$Therefore, it is controllable. Similarly, $$\text{rank }O=\text{rank }\begin{bmatrix}0&0&2\\0&4&2\\4&4&2\end{bmatrix}=3$$Hence, the system is also observable.
2. We want the characteristic polynomial of $A+BK$ to equal: $$\lambda^3+6\lambda^2+12\lambda+8$$and $$\begin{align}\det(\lambda I-A-BK)&=\det\begin{bmatrix}\lambda-3k_{1}&-3k_{2}&-3k_{3}-2\\-1&\lambda&0\\0&-2&\lambda-1\end{bmatrix}\\&=(\lambda-3k_{1})(\lambda^{2}-\lambda)+3k_{2}(1-\lambda)-2(3k_{3}+2)\\&=\lambda^3+(-3k_{1}-1)\lambda^{2}+(3k_{1}-3k_{2})\lambda+(3k_{2}-6k_{3}-4)\end{align}$$Therefore, 
	1. $k_{1}=-\frac{7}{3}$
	2. $k_{2}=-\frac{19}{3}$
	3. $k_{3}=-\frac{31}{6}$
	   
	and $K=\begin{bmatrix}-\frac{7}{3}&-\frac{19}{3}&-\frac{31}{6}\end{bmatrix}$.
3. We have: $$\begin{align}\text{det}(\lambda I-A+LC)&=\det \begin{bmatrix}\lambda&0&2\ell_{1}-2\\-1&\lambda&2\ell_{2}\\0&-2&\lambda-1+2\ell_{3}\end{bmatrix}\\&=\lambda(\lambda^{2}-\lambda+2\ell_{3}\lambda+4\ell_{2})+(4\ell_{1}-4)\\&=\lambda^{3}+(2\ell_{3}-1)\lambda^{2}+4\ell_{2}\lambda+(4\ell_{1}-4)\\&\overset{ ! }{ = }\lambda^3+9\lambda^{2}+27\lambda+27\end{align}$$Therefore, $\ell_{1}=\frac{31}{4}$, $\ell_{2}=\frac{27}{4}$ and $\ell_{3}=5$. It follows that: $$L=\begin{bmatrix} \frac{31}{4}\\ \frac{27}{4}\\5\end{bmatrix}$$
---
##### Exercise 5
1. We have the controllability matrix: $$C(\omega)=[B\ A(w)B]=\begin{bmatrix}0&\omega\\1&0\end{bmatrix}$$Therefore, the system is controllable if $\omega\neq 0$. At $\omega=0$, $\text{Spec}(A)=\{ -1,0 \}$ and for $\lambda=-1$, $$\text{rank}\begin{bmatrix}0&0&0\\0&1&1\end{bmatrix}=1<2$$But, for $\lambda=0$, $$\text{rank}\begin{bmatrix}-1&0&0\\0&0&1\end{bmatrix}=2$$This proves that the system is stabilizable when $\omega=0$. For observability, $$O(\omega)=\begin{bmatrix}C\\CA\end{bmatrix}=\begin{bmatrix}1&0\\-1&w\end{bmatrix}$$Therefore, the system is observable if $\omega\neq 0$. When $\omega=0$, for $\lambda=-1$, $$\text{rank}\begin{bmatrix}0&0\\0&1\\1&0\end{bmatrix}=2$$and for $\lambda=0$, $$\text{rank}\begin{bmatrix}-1&0\\0&0\\1&0\end{bmatrix}=1<2$$This shows that the system is not detectable when $\omega=0$.
2. We want our characteristic polynomial to equal: $$\lambda^2+2\lambda+1$$But we have: $$\text{det}(A(\omega)+BK(\omega))=\det \begin{bmatrix}-1&\omega\\k_{1}(\omega)&k_{2}(\omega)\end{bmatrix} =\lambda^{2}+(1-k_{2}(\omega))\lambda-k_{2}(\omega)-\omega k_{1}(\omega)$$Therefore, $k_{2}(\omega)=-1$ and $\omega k_{1}(\omega)=0$. If $\omega\neq 0$, we then have: $K=[0\ -1]$. If $\omega=0$, then $K=[k_{1}\ -1]$ for any $k_{1}\in \mathbb{R}$. For $\omega=0$, the system is not controllable, but the uncontrollable mode $\lambda=-1$ is already in the desired set $\{ -1 \}$. Therefore, this is not a problem.
3. We need the eigenvalues of $A(\omega)-L(\omega)C$ to have a negative real part. Therefore, $$A(\omega)-L(\omega)C=\begin{bmatrix}-\ell_{1}(\omega)-1&\omega\\-\ell_{2}(\omega)&0\end{bmatrix}$$with characteristic polynomial: $\lambda^2+(\ell_{1}(\omega)+1)\lambda+\omega \ell_{2}(\omega)$. Using the Descartes' rule, if $\omega>0$, $\ell_{2}(\omega)>0$ and $\ell_{1}(\omega)>-1$. If $\omega<0$, then $\ell_{1}(\omega)>-1$ and $\ell_{2}(\omega)<0$. If $\omega=0$, this is not possible.
4. If $\omega\neq0$ and $u(t)=0$ for all $t\geq 0$, we have the following system: $$\begin{align}\dot{x}_{1}(t)&=-x_{1}(t)+\omega x_{2}(t)\\\dot{x}_{2}(t)&=0\\y(t)&=x_{1}(t)\end{align}$$Therefore, $x_{2}(t)$ is constant, i.e. $x_{2}(t)=x_{2}(0)$ and: $$\begin{align}x_{1}(t)&=e^{-t}x_{1}(0)+\int_{0}^{t} e^{-(t-\tau)}wx_{2}(0) \, d\tau\\&=e^{-t}x_{1}(0)+(1-e^{-t})wx_{2}(0)\end{align} $$It follows that: $$x(t)=\begin{bmatrix}e^{-t}&(1-e^{-t})w\\0&1\end{bmatrix}x(0)$$Consequently, $$\begin{align}y(0)&=x_{1}(0)\\y(1)&=e^{-1}x_{1}(0)+(1-e^{-1})wx_{2}(0)\end{align}$$Therefore, $$x(0)=\begin{bmatrix} 1&0\\-\frac{1}{w(e-1)}& \frac{e}{w(e-1)}\end{bmatrix}\begin{bmatrix}y(0)\\y(1)\end{bmatrix}$$
---